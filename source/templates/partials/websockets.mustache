<script>
	// handle page updates from one browser to another
	var wsp = new WebSocket("ws://{{ websocketaddress }}:8000/pageupdate");
	wsp.onmessage = function (event) {
	
		if ($sgViewport.attr('src') != event.data) {
			$sgViewport.attr('src',event.data+'?'+dataPrevious);
		}
		
	}

	// handle content updates generated by the watch
	var dc = true;
	var dataPrevious = 0;
	var wsc = new WebSocket("ws://{{ websocketaddress }}:8002/contentupdate");
	wsc.onmessage = function (event) {
	
		if (dc !== false) {
			if (event.data != dataPrevious) {
				$sgViewport.attr('src',$sgViewport.attr('src')+'?'+event.data);
				dataPrevious = event.data;
			}
		} else {
			dc = true;
			if (vals[0] == "t") {
				dataPrevious = event.data;
			}
		}
	
	}
</script>